sudo apt-get -y install vim curl git git-lfs mpv ninja-build cmake meson zathura nomacs python3-pip \
                        htop pandoc flameshot

# Set up the $HOME/bin directory
mkdir -p $HOME/bin

# Download the scripts
pushd $HOME/bin > /dev/null
wget -q -O mexican-mode https://raw.githubusercontent.com/kociap/ubuntu-utilities/master/mexican-mode
chmod +x mexican-mode
popd > /dev/null

source $HOME/.profile

# Initialise mexican mode defaults
mexican-mode -i

# Alias python
sudo ln -s /usr/bin/python3 /usr/bin/python

# Setup keyboard and mouse
gsettings set org.gnome.desktop.peripherals.mouse accel-profile "flat"
gsettings set org.gnome.desktop.peripherals.mouse speed 0.0
gsettings set org.gnome.desktop.peripherals.keyboard delay 300

# Remove workspace keybinds as they interfere with the vscode keybinds
gsettings set org.gnome.desktop.wm.keybindings move-to-workspace-down []
gsettings set org.gnome.desktop.wm.keybindings move-to-workspace-up []
gsettings set org.gnome.desktop.wm.keybindings move-to-workspace-left []
gsettings set org.gnome.desktop.wm.keybindings move-to-workspace-right []
gsettings set org.gnome.desktop.wm.keybindings move-to-workspace-last []
gsettings set org.gnome.desktop.wm.keybindings switch-to-workspace-down []
gsettings set org.gnome.desktop.wm.keybindings switch-to-workspace-last []
gsettings set org.gnome.desktop.wm.keybindings switch-to-workspace-left []
gsettings set org.gnome.desktop.wm.keybindings switch-to-workspace-right []
gsettings set org.gnome.desktop.wm.keybindings switch-to-workspace-up []

# Setup Flameshot keybind
gsettings set org.gnome.shell.keybindings show-screenshot-ui []
gsettings set org.gnome.shell.keybindings screenshot-window []
gsettings set org.gnome.shell.keybindings screenshot []
gsettings set org.gnome.settings-daemon.plugins.media-keys custom-keybindings "['/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/']"
gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/ name "flameshot"
gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/ command "flameshot gui"
gsettings set org.gnome.settings-daemon.plugins.media-keys.custom-keybinding:/org/gnome/settings-daemon/plugins/media-keys/custom-keybindings/custom0/ binding "Print"

# Add repositories
## LLVM and Clang
source /etc/os-release
wget -qO- https://apt.llvm.org/llvm-snapshot.gpg.key | sudo tee /etc/apt/trusted.gpg.d/llvm.asc > /dev/null
echo "deb [arch=amd64] http://apt.llvm.org/${UBUNTU_CODENAME}/ llvm-toolchain-${UBUNTU_CODENAME} main" | sudo tee /etc/apt/sources.list.d/llvm.list > /dev/null
## VSCode
wget -qO- https://packages.microsoft.com/keys/microsoft.asc | sudo tee /etc/apt/trusted.gpg.d/microsoft.asc > /dev/null
echo "deb [arch=amd64] http://packages.microsoft.com/repos/vscode stable main" | sudo tee /etc/apt/sources.list.d/vscode.list > /dev/null

# Install LLVM, Clang, VSCode
sudo apt-get update
sudo apt-get -y install code llvm clang clangd clang-format clang-tidy clang-tools lld

# Download vscode user settings and keybinds
mkdir -p $HOME/.config/Code/User
pushd $HOME/.config/Code/User > /dev/null
wget -q -O keybindings.json https://raw.githubusercontent.com/kociap/ubuntu-utilities/master/keybindings.json
popd > /dev/null

# Final upgrade and cleanup
sudo apt-get -y upgrade
sudo apt-get -y autoremove
